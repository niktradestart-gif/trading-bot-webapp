<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>ASPIRE TRADE ‚Äî Live</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <meta name="theme-color" content="#0b0f19"/>
  <style>
    :root{
      --bg:#0b0f19;
      --card1:rgba(20,26,48,.72);
      --card2:rgba(15,19,34,.86);
      --muted:#8d95af;
      --text:#e9ecf5;
      --good:#27e0a1;
      --bad:#ff5c7a;
      --accent:#5aa6ff;
      --accent2:#7b5bff;
      --border:rgba(255,255,255,.06);
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --radius:16px;
    }
    *{box-sizing:border-box}
    html,body{
      margin:0;padding:0;
      background:
        radial-gradient(1200px 600px at 50% -10%, rgba(90,166,255,.08), transparent 60%),
        var(--bg);
      color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans";
    }

    .wrap{min-height:100dvh;display:flex;flex-direction:column;gap:14px;padding:16px 14px 24px;align-items:center}
    .topbar{width:100%;max-width:900px;display:flex;align-items:center;justify-content:space-between;gap:10px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800;letter-spacing:.5px}
    .dot{width:10px;height:10px;border-radius:50%;background:linear-gradient(135deg,var(--accent),var(--accent2));box-shadow:0 0 18px rgba(122,139,255,.6)}
    .userbox{display:flex;align-items:center;gap:8px;font-size:13px;color:var(--muted)}
    .logout{
      font-size:12px;padding:7px 12px;border-radius:999px;border:1px solid var(--border);
      background:linear-gradient(180deg, rgba(20,26,48,.65), rgba(15,19,34,.82));
      color:var(--text);text-decoration:none;cursor:pointer;transition:.2s;backdrop-filter:blur(6px)
    }
    .logout:hover{transform:translateY(-1px);box-shadow:0 8px 20px rgba(0,0,0,.25)}

    .grid{width:100%;max-width:900px;display:grid;grid-template-columns:1fr;gap:14px}

    .card{
      background:linear-gradient(180deg, var(--card1), var(--card2));
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .card__inner{padding:14px}
    .title{font-size:18px;font-weight:800;letter-spacing:.3px;margin:0 0 8px 0;display:flex;gap:8px;align-items:center}
    .badge{font-size:12px;padding:2px 8px;border-radius:999px;border:1px solid var(--border);color:var(--muted)}
    .center{display:flex;flex-direction:column;align-items:center;gap:12px}

    .chart-wrap{
      width:100%;
      max-width:760px;
      aspect-ratio:16/10;
      border-radius:12px;
      overflow:hidden;
      background:#0b0f19;
      border:1px solid var(--border);
      position:relative;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.02);
    }
    .chart{width:100%;height:100%;display:block;object-fit:cover}
    .chart--hidden{display:none}

    .signal{width:100%;display:grid;gap:8px;grid-template-columns:repeat(2,minmax(0,1fr))}
    .item{background:rgba(255,255,255,.02);border:1px solid var(--border);border-radius:12px;padding:10px 12px;display:flex;flex-direction:column;gap:4px}
    .label{font-size:12px;color:var(--muted)}
    .val{font-size:16px;font-weight:800}
    .val.buy{color:var(--good)}
    .val.sell{color:var(--bad)}
    .val.em{color:var(--accent)}

    .timerBox{width:100%;max-width:760px;display:flex;flex-direction:column;gap:8px;align-items:center}
    .timerText{font-variant-numeric:tabular-nums;font-size:18px;font-weight:800;letter-spacing:.5px}
    .bar{width:100%;height:10px;border-radius:999px;border:1px solid var(--border);background:rgba(255,255,255,.05);overflow:hidden;position:relative;box-shadow:inset 0 0 0 1px rgba(255,255,255,.02)}
    .bar__fill{position:absolute;left:0;top:0;bottom:0;width:100%;background:linear-gradient(90deg, var(--accent2), var(--accent));box-shadow:0 0 12px rgba(123,91,255,.35);transition:width .25s linear}

    .deal{
      width:100%;max-width:760px;
      background:linear-gradient(180deg, rgba(25,13,20,.75), rgba(20,12,18,.92));
      border:1px solid rgba(255,92,122,.35);
      border-radius:14px;padding:16px;
      display:none;animation:.35s ease fadeIn;box-shadow:0 10px 30px rgba(255,92,122,.18)
    }
    .deal.win{background:linear-gradient(180deg, rgba(17,33,28,.75), rgba(14,26,23,.92));border:1px solid rgba(39,224,161,.35);box-shadow:0 10px 30px rgba(39,224,161,.18)}
    .deal .h{display:flex;align-items:center;gap:8px;font-weight:900;letter-spacing:.4px}
    .deal .h .dot{width:10px;height:10px;background:var(--bad)}
    .deal.win .h .dot{background:var(--good)}
    .rows{margin-top:10px;display:grid;gap:8px;grid-template-columns:repeat(2,minmax(0,1fr))}
    .r{background:rgba(255,255,255,.02);border:1px solid var(--border);border-radius:10px;padding:10px 12px}
    .r .label{font-size:12px;color:var(--muted)}
    .r .val{font-weight:800;font-size:16px}
    .fade-in{animation:.3s ease fadeIn}
    @keyframes fadeIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:none}}
    .hide{display:none!important}

    /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–∞–Ω–µ–ª–∏ –æ—à–∏–±–æ–∫ */
    .error-panel {
      position: fixed;
      bottom: 60px;
      right: 10px;
      background: rgba(0,0,0,0.95);
      color: white;
      padding: 15px;
      border-radius: 10px;
      z-index: 10000;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      max-width: 400px;
      max-height: 300px;
      overflow-y: auto;
      border: 2px solid #ff4444;
      display: none;
    }

    .error-button {
      position: fixed;
      bottom: 10px;
      left: 10px;
      background: #ff4444;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 20px;
      z-index: 10000;
      font-family: system-ui;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(255,0,0,0.3);
    }

    .status-panel {
      position: fixed;
      top: 10px;
      right: 10px;
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 8px 12px;
      border-radius: 8px;
      z-index: 10000;
      font-family: system-ui;
      font-size: 12px;
      font-weight: 600;
      border: 2px solid white;
    }

    @media (max-width:480px){
      .title{font-size:16px}
      .signal{grid-template-columns:1fr 1fr}
      .rows{grid-template-columns:1fr 1fr}
      .logout{padding:6px 10px}
      .error-panel {
        max-width: 300px;
        right: 5px;
        bottom: 50px;
      }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand"><span class="dot"></span><span>ASPIRE TRADE</span></div>
      <div class="userbox">
        <span id="userId">ID: ‚Äî</span>
        <button class="logout" id="logoutBtn">–í—ã–π—Ç–∏</button>
      </div>
    </div>

    <div class="grid">
      <div class="card">
        <div class="card__inner center">

          <h3 class="title">–¢–ï–ö–£–©–ò–ô –°–ò–ì–ù–ê–õ <span id="sigSource" class="badge">‚Äî</span></h3>

          <div class="chart-wrap">
            <img id="chartImg" class="chart" alt="chart">
          </div>

          <div class="signal">
            <div class="item"><div class="label">–ü–∞—Ä–∞</div><div id="pair" class="val em">‚Äî</div></div>
            <div class="item"><div class="label">–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</div><div id="direction" class="val">‚Äî</div></div>
            <div class="item"><div class="label">–í—Ö–æ–¥</div><div id="entry" class="val">‚Äî</div></div>
            <div class="item"><div class="label">–≠–∫—Å–ø–∏—Ä–∞—Ü–∏—è</div><div id="expiry" class="val">‚Äî</div></div>
          </div>

          <div class="timerBox">
            <div id="timerText" class="timerText">‚è≥ ‚Äî:‚Äî</div>
            <div class="bar"><div id="barFill" class="bar__fill" style="width:100%"></div></div>
          </div>

          <div id="dealCard" class="deal">
            <div class="h"><span class="dot"></span><span id="dealTitle">–°–î–ï–õ–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê</span></div>
            <div class="rows">
              <div class="r"><div class="label">–ü–∞—Ä–∞</div><div id="d_pair" class="val">‚Äî</div></div>
              <div class="r"><div class="label">–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</div><div id="d_dir" class="val">‚Äî</div></div>
              <div class="r"><div class="label">–í—Ö–æ–¥</div><div id="d_entry" class="val">‚Äî</div></div>
              <div class="r"><div class="label">–í—ã—Ö–æ–¥</div><div id="d_exit" class="val">‚Äî</div></div>
              <div class="r" style="grid-column:1/-1"><div class="label">–†–µ–∑—É–ª—å—Ç–∞—Ç</div><div id="d_res" class="val">‚Äî</div></div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

<script>
(() => {
  const state = {
    // –ú–ù–û–ñ–ï–°–¢–í–ï–ù–ù–´–ï ENDPOINTS –î–õ–Ø –†–ï–ó–ï–†–í–ò–†–û–í–ê–ù–ò–Ø
    apiEndpoints: [
      'https://nonurban-joella-unvagrantly.ngrok-free.dev',
      'http://89.23.98.206:8080',
      window.location.origin
    ],
    currentEndpointIndex: 0,
    pollMs: 5000,
    lastSignalTs: 0,
    lastTradeIdShown: null,
    timerInt: null,
    totalMs: 0,
    expiryMs: 0,
    errorCount: 0
  };

  // –¢–ï–ö–£–©–ò–ô API BASE
  state.apiBase = state.apiEndpoints[state.currentEndpointIndex];

  const el = s => document.querySelector(s);
  const pad = x => String(x).padStart(2,'0');
  const fmt = n => (n===null||n===undefined) ? "‚Äî" : (typeof n==="number" ? (Math.abs(n) >= 1 ? n.toFixed(5) : n.toPrecision(6)) : n);

  // -------- –ü–ê–ù–ï–õ–¨ –°–¢–ê–¢–£–°–ê --------
  const statusEl = document.createElement('div');
  statusEl.className = 'status-panel';
  statusEl.innerHTML = 'üîÑ –ó–∞–≥—Ä—É–∑–∫–∞...';
  document.body.appendChild(statusEl);

  function updateStatus(message, isError = false) {
    statusEl.innerHTML = message;
    statusEl.style.background = isError ? '#ff4444' : '#10b981';
    statusEl.style.borderColor = isError ? '#ff0000' : '#ffffff';
  }

  // -------- –ü–ê–ù–ï–õ–¨ –û–®–ò–ë–û–ö --------
  const errorPanel = document.createElement('div');
  errorPanel.className = 'error-panel';
  errorPanel.innerHTML = `
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
      <strong>üö® –ü–ê–ù–ï–õ–¨ –û–®–ò–ë–û–ö</strong>
      <button onclick="document.querySelector('.error-panel').style.display='none'" 
              style="background: #ff4444; border: none; color: white; padding: 5px 10px; border-radius: 5px; cursor: pointer;">
        ‚úï
      </button>
    </div>
    <div id="errorLogs" style="color: #ff6b6b; max-height: 200px; overflow-y: auto;"></div>
  `;
  document.body.appendChild(errorPanel);

  const errorButton = document.createElement('button');
  errorButton.className = 'error-button';
  errorButton.innerHTML = 'üö® –û—à–∏–±–∫–∏';
  errorButton.onclick = () => {
    errorPanel.style.display = errorPanel.style.display === 'none' ? 'block' : 'none';
  };
  document.body.appendChild(errorButton);

  const errorLogs = [];
  const maxLogs = 15;

  function addErrorLog(message, type = 'error') {
    const timestamp = new Date().toLocaleTimeString();
    const logEntry = { time: timestamp, message: message, type: type };
    
    errorLogs.unshift(logEntry);
    if (errorLogs.length > maxLogs) errorLogs.pop();
    
    updateErrorDisplay();
    
    if (type === 'error') {
      errorPanel.style.display = 'block';
      state.errorCount++;
    }
  }

  function updateErrorDisplay() {
    const errorLogsElement = document.getElementById('errorLogs');
    errorLogsElement.innerHTML = errorLogs.map(log => `
      <div style="margin: 5px 0; padding: 5px; background: rgba(255,0,0,0.1); border-radius: 3px; border-left: 3px solid ${log.type === 'error' ? '#ff4444' : '#ffa500'}">
        <span style="color: #ccc; font-size: 10px;">[${log.time}]</span><br>
        <span style="color: ${log.type === 'error' ? '#ff6b6b' : '#ffa500'};">${log.message}</span>
      </div>
    `).join('');
  }

  // -------- –ü–ï–†–ï–•–í–ê–¢ –û–®–ò–ë–û–ö --------
  const originalConsoleError = console.error;
  console.error = function(...args) {
    originalConsoleError.apply(console, args);
    addErrorLog(args.join(' '), 'error');
  };

  const originalConsoleWarn = console.warn;
  console.warn = function(...args) {
    originalConsoleWarn.apply(console, args);
    addErrorLog(args.join(' '), 'warning');
  };

  window.addEventListener('error', (e) => {
    addErrorLog(`JavaScript: ${e.error || e.message}`, 'error');
  });

  window.addEventListener('unhandledrejection', (e) => {
    addErrorLog(`Promise: ${e.reason}`, 'error');
  });

  // -------- header: user id + logout --------
  async function initHeader(){
    let uid = localStorage.getItem('user_id') || localStorage.getItem('uid') || null;

    if(!uid){
      try{
        let r = await fetch(`${state.apiBase}/api/pocket_users.json`, {cache:'no-store'});
        if(!r.ok) throw 0;
        const j = await r.json();
        uid = extractUserIdFromPocket(j);
      }catch(_){
        try{
          let r2 = await fetch(`${state.apiBase}/pocket_users.json`, {cache:'no-store'});
          if(r2.ok){
            const j2 = await r2.json();
            uid = extractUserIdFromPocket(j2);
          }
        }catch(__){}
      }
    }

    el('#userId').textContent = `ID: ${uid || '‚Äî'}`;
    el('#logoutBtn').addEventListener('click', ()=>{
      try{ localStorage.clear(); }catch(_){}
      setTimeout(()=>{ location.href = 'login.html'; }, 80);
    });
  }

  function extractUserIdFromPocket(obj){
    try{
      if(Array.isArray(obj?.users) && obj.users.length){
        const current = obj.users.find(u => u.current || u.active);
        return String((current || obj.users[0]).id || '');
      }
      const keys = Object.keys(obj||{});
      if(keys.length){ return String(keys[0]); }
    }catch(_){}
    return null;
  }

  // -------- helpers --------
  function setChartVisible(v){
    const img = el('#chartImg');
    if(v) img.classList.remove('chart--hidden'); else img.classList.add('chart--hidden');
  }
  
  function setDealVisible(v, isWin=false){
    const card = el('#dealCard');
    if(v){
      card.style.display = 'block';
      card.classList.add('fade-in');
      isWin ? card.classList.add('win') : card.classList.remove('win');
    }else{
      card.style.display = 'none';
      card.classList.remove('win');
    }
  }

  function startTimer(createdTs, expiryMinutes){
    clearInterval(state.timerInt);

    if(!createdTs || !expiryMinutes){
      el('#timerText').textContent = '‚è≥ ‚Äî:‚Äî';
      el('#barFill').style.width = '0%';
      return;
    }

    const createdMs = (typeof createdTs === 'number') ? createdTs : new Date(createdTs).getTime();
    const expiryMs  = createdMs + (expiryMinutes * 60 * 1000);
    const totalMs   = Math.max(1, expiryMs - createdMs);

    state.expiryMs = expiryMs;
    state.totalMs  = totalMs;

    const tick = () => {
      const now = Date.now();
      const rem = Math.max(0, expiryMs - now);
      const mm = Math.floor(rem/1000/60);
      const ss = Math.floor(rem/1000) % 60;
      el('#timerText').textContent = `‚è≥ –û—Å—Ç–∞–ª–æ—Å—å: ${pad(mm)}:${pad(ss)}`;

      const pct = Math.max(0, Math.min(100, (rem / totalMs) * 100));
      el('#barFill').style.width = `${pct}%`;

      if(rem<=0){
        clearInterval(state.timerInt);
      }
    };

    tick();
    state.timerInt = setInterval(tick, 250);
  }

  // -------- –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï ENDPOINTS --------
  async function switchToNextEndpoint() {
    state.currentEndpointIndex = (state.currentEndpointIndex + 1) % state.apiEndpoints.length;
    state.apiBase = state.apiEndpoints[state.currentEndpointIndex];
    addErrorLog(`üîÄ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ endpoint: ${state.apiBase}`, 'warning');
    updateStatus(`üîÄ ${state.apiBase}`);
    return state.apiBase;
  }

  // -------- –£–õ–£–ß–®–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ó–ê–ì–†–£–ó–ö–ò --------
  async function loadLatest(){
    const originalEndpoint = state.apiBase;
    
    try{
      updateStatus('üîÑ –ó–∞–≥—Ä—É–∑–∫–∞...');
      console.log(`üì° –ó–∞–ø—Ä–æ—Å –∫: ${state.apiBase}`);
      
      const url = `${state.apiBase}/api/latest_full.json?_t=${Date.now()}`;
      const response = await fetch(url, {
        method: 'GET',
        mode: 'cors',
        cache: 'no-store',
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        }
      });
      
      if(!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }
      
      const data = await response.json();
      console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã:', data);
      
      // –°–ë–†–ê–°–´–í–ê–ï–ú –°–ß–ï–¢–ß–ò–ö –û–®–ò–ë–û–ö –ü–†–ò –£–°–ü–ï–•–ï
      state.errorCount = 0;
      updateStatus(`‚úÖ ${state.apiBase.replace('https://', '').replace('http://', '')}`);
      addErrorLog(`‚úÖ –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å: ${state.apiBase}`, 'info');

      const sig = data?.signal || null;
      const res = data?.result || null;
      const chartB64 = data?.chart_base64 || null;

      let showSignal = false;
      if(sig){
        const created = sig?.timestamp ?? sig?.created_at ?? null;
        const expMin  = sig?.expiry ?? sig?.expiry_minutes ?? null;
        if(created && expMin){
          const createdMs = (typeof created==='number') ? created : new Date(created).getTime();
          const expMs = createdMs + expMin*60*1000;
          showSignal = expMs > Date.now();
        }
      }

      if(showSignal){
        const stamp = sig?.timestamp ? (typeof sig.timestamp==='number' ? sig.timestamp : new Date(sig.timestamp).getTime())
                                     : (sig?.created_at ? new Date(sig.created_at).getTime() : Date.now());
        if (stamp !== state.lastSignalTs){
          state.lastSignalTs = stamp;
          renderSignal(sig, chartB64);
        } else {
          startTimer(sig?.timestamp ?? sig?.created_at ?? null, sig?.expiry ?? sig?.expiry_minutes ?? null);
        }
      }else if(res){
        if(res.trade_id !== state.lastTradeIdShown){
          state.lastTradeIdShown = res.trade_id;
          renderCompleted(res);
        }
      }else{
        console.log('‚ÑπÔ∏è –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö');
        updateStatus('‚ÑπÔ∏è –û–∂–∏–¥–∞–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞');
      }
      
    }catch(e){
      console.warn('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', e);
      addErrorLog(`‚ùå ${e.message} - ${state.apiBase}`, 'error');
      updateStatus(`‚ùå ${state.apiBase.replace('https://', '').replace('http://', '')}`, true);
      
      // –ü–ï–†–ï–ö–õ–Æ–ß–ê–ï–ú ENDPOINT –ü–†–ò –û–®–ò–ë–ö–ê–•
      if (state.errorCount > 2) {
        await switchToNextEndpoint();
        state.errorCount = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
      }
    }
  }

  // -------- renderers --------
  function renderSignal(sig, chartBase64){
    setDealVisible(false);
    setChartVisible(true);

    el('#sigSource').textContent = sig?.source ?? '‚Äî';
    el('#pair').textContent      = sig?.pair ?? '‚Äî';

    const dir = String(sig?.direction||'‚Äî').toUpperCase();
    const dirEl = el('#direction');
    dirEl.textContent = dir;
    dirEl.classList.remove('buy','sell');
    if(dir==='BUY')  dirEl.classList.add('buy');
    if(dir==='SELL') dirEl.classList.add('sell');

    el('#entry').textContent = fmt(sig?.entry_price ?? sig?.entry);

    const createdTs = sig?.timestamp ?? sig?.created_at ?? Date.now();
    const expMin    = sig?.expiry ?? sig?.expiry_minutes ?? null;
    if(createdTs && expMin){
      const expAt = new Date((typeof createdTs==='number'?createdTs:new Date(createdTs).getTime()) + expMin*60*1000);
      el('#expiry').textContent = expAt.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
      startTimer(createdTs, expMin);
    }else{
      el('#expiry').textContent = '‚Äî';
      startTimer(null, null);
    }

    if(chartBase64){
      el('#chartImg').src = chartBase64.startsWith("data:image") 
        ? chartBase64 
        : `data:image/png;base64,${chartBase64}`;
    }
  }

  function renderCompleted(res){
    const id   = res?.trade_id ?? '‚Äî';
    const pair = res?.pair ?? '‚Äî';
    const dir  = res?.direction ? String(res.direction).toUpperCase() : '‚Äî';
    const entry= res?.entry_price ?? res?.entry ?? '‚Äî';
    const exit = res?.exit_price  ?? res?.exit  ?? '‚Äî';
    const result = (res?.result || '‚Äî').toUpperCase();

    const prefix = (result==='WIN') ? 'üü¢ –°–î–ï–õ–ö–ê #' : 'üî¥ –°–î–ï–õ–ö–ê #';
    el('#dealTitle').textContent = `${prefix}${id} –ó–ê–í–ï–†–®–ï–ù–ê`;

    el('#d_pair').textContent  = pair;
    el('#d_dir').textContent   = dir;
    el('#d_entry').textContent = fmt(entry);
    el('#d_exit').textContent  = fmt(exit);
    el('#d_res').textContent   = result;

    setChartVisible(false);
    setDealVisible(true, result==='WIN');

    clearInterval(state.timerInt);
    el('#timerText').textContent = '‚è≥ ‚Äî:‚Äî';
    el('#barFill').style.width = '0%';
  }

  async function boot(){
    addErrorLog('üöÄ –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—â–µ–Ω–∞', 'info');
    updateStatus('üöÄ –ó–∞–ø—É—Å–∫...');
    
    await initHeader();
    loadLatest();
    setInterval(loadLatest, state.pollMs);
    
    // –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–¢–ê–¢–£–°–ê –ö–ê–ñ–î–£–Æ –°–ï–ö–£–ù–î–£
    setInterval(() => {
      const now = new Date().toLocaleTimeString();
      errorButton.innerHTML = `üö® –û—à–∏–±–∫–∏ (${state.errorCount})`;
    }, 1000);
  }

  window.addEventListener('load', boot);
})();
</script>
</body>
</html>
